// ==========================================
// 1. YOUR LOCATION DATA (Edit this section as you need)
// ==========================================
const locationData = {
    "ANDAMAN AND NICOBAR ISLAND": [
        "NICOBARS",
        "NORTH AND MIDDLE ANDAMAN",
        "SOUTH ANDAMANS"
    ],
    "ANDAMAN AND NICOBAR ISLANDS": [
        "NICOBARS",
        "NORTH AND MIDDLE ANDAMAN",
        "SOUTH ANDAMANS",
        "ANDAMAN AND NICOBAR ISLANDS"
    ],
    "ANDHRA PRADESH": [
        "ADILABAD",
        "ANANTAPUR",
        "CHITTOOR",
        "EAST GODAVARI",
        "GUNTUR",
        "KADAPA",
        "KARIMNAGAR",
        "KHAMMAM",
        "KRISHNA",
        "KURNOOL",
        "MAHBUBNAGAR",
        "MEDAK",
        "NALGONDA",
        "NIZAMABAD",
        "PRAKASAM",
        "RANGAREDDI",
        "SPSR NELLORE",
        "SRIKAKULAM",
        "VISAKHAPATANAM",
        "VIZIANAGARAM",
        "WARANGAL",
        "WEST GODAVARI",
        "HYDERABAD",
        "VISAKHAPATNAM",
        "S.P.S. NELLORE",
        "ANANTHAPUR",
        "KADAPA YSR"
    ],
    "ARUNACHAL PRADESH": [
        "ANJAW",
        "CHANGLANG",
        "DIBANG VALLEY",
        "EAST KAMENG",
        "EAST SIANG",
        "KAMLE",
        "KRA DAADI",
        "KURUNG KUMEY",
        "LEPARADA",
        "LOHIT",
        "LONGDING",
        "LOWER DIBANG VALLEY",
        "LOWER SIANG",
        "LOWER SUBANSIRI",
        "NAMSAI",
        "PAKKE KESSANG",
        "PAPUM PARE",
        "SHI YOMI",
        "SIANG",
        "TAWANG",
        "TIRAP",
        "UPPER SIANG",
        "UPPER SUBANSIRI",
        "WEST KAMENG",
        "WEST SIANG"
    ],
    "ASSAM": [
        "BAKSA",
        "BARPETA",
        "BONGAIGAON",
        "CACHAR",
        "CHIRANG",
        "DARRANG",
        "DHEMAJI",
        "DHUBRI",
        "DIBRUGARH",
        "DIMA HASAO",
        "GOALPARA",
        "GOLAGHAT",
        "HAILAKANDI",
        "JORHAT",
        "KAMRUP",
        "KAMRUP METRO",
        "KARBI ANGLONG",
        "KARIMGANJ",
        "KOKRAJHAR",
        "LAKHIMPUR",
        "MARIGAON",
        "NAGAON",
        "NALBARI",
        "SIVASAGAR",
        "SONITPUR",
        "TINSUKIA",
        "UDALGURI",
        "NORTH CACHAR HIL / DIMA HASAO",
        "SIBSAGAR"
    ],
    "BIHAR": [
        "ROHTAS",
        "SIWAN",
        "ARARIA",
        "ARWAL",
        "AURANGABAD",
        "BANKA",
        "BEGUSARAI",
        "BHAGALPUR",
        "BHOJPUR",
        "BOKARO",
        "BUXAR",
        "CHATRA",
        "DARBHANGA",
        "DEOGHAR",
        "DHANBAD",
        "DUMKA",
        "EAST SINGHBUM",
        "GARHWA",
        "GAYA",
        "GIRIDIH",
        "GODDA",
        "GOPALGANJ",
        "GUMLA",
        "HAZARIBAGH",
        "JAMUI",
        "JEHANABAD",
        "KAIMUR (BHABUA)",
        "KATIHAR",
        "KHAGARIA",
        "KISHANGANJ",
        "KODERMA",
        "LAKHISARAI",
        "LOHARDAGA",
        "MADHEPURA",
        "MADHUBANI",
        "MUNGER",
        "MUZAFFARPUR",
        "NALANDA",
        "NAWADA",
        "PAKUR",
        "PALAMU",
        "PASHCHIM CHAMPARAN",
        "PATNA",
        "PURBI CHAMPARAN",
        "PURNIA",
        "RANCHI",
        "SAHARSA",
        "SAHEBGANJ",
        "SAMASTIPUR",
        "SARAN",
        "SHEIKHPURA",
        "SHEOHAR",
        "SITAMARHI",
        "SUPAUL",
        "VAISHALI",
        "WEST SINGHBHUM",
        "CHAMPARAN",
        "PURNEA",
        "MUNGAIR",
        "SHAHABAD (NOW PART OF BHOJPUR DISTRICT)"
    ],
    "CHANDIGARH": [
        "CHANDIGARH"
    ],
    "CHHATTISGARH": [
        "BALOD",
        "BALODA BAZAR",
        "BALRAMPUR",
        "BASTAR",
        "BEMETARA",
        "BILASPUR",
        "DANTEWADA",
        "DURG",
        "GARIYABAND",
        "KABIRDHAM",
        "KANKER",
        "KONDAGAON",
        "KOREA",
        "RAIPUR",
        "RAJNANDGAON",
        "SURGUJA",
        "BIJAPUR",
        "DHAMTARI",
        "GAURELLA-PENDRA-MARWAHI",
        "JANJGIR-CHAMPA",
        "JASHPUR",
        "KORBA",
        "MAHASAMUND",
        "MUNGELI",
        "NARAYANPUR",
        "RAIGARH",
        "SUKMA",
        "SURAJPUR"
    ],
    "DADRA AND NAGAR HAVELI": [
        "DADRA AND NAGAR HAVELI"
    ],
    "DAMAN AND DIU": [
        "DAMAN",
        "DAMAN AND DIU"
    ],
    "DELHI": [
        "DELHI_TOTAL",
        "DELHI"
    ],
    "GOA": [
        "NORTH GOA",
        "SOUTH GOA",
        "GOA"
    ],
    "GUJARAT": [
        "AHMADABAD",
        "AMRELI",
        "ANAND",
        "ARAVALLI",
        "BANAS KANTHA",
        "BHARUCH",
        "BHAVNAGAR",
        "BOTAD",
        "CHHOTAUDEPUR",
        "DEVBHUMI DWARKA",
        "DOHAD",
        "GANDHINAGAR",
        "GIR SOMNATH",
        "JAMNAGAR",
        "JUNAGADH",
        "KACHCHH",
        "KHEDA",
        "MAHESANA",
        "MAHISAGAR",
        "MORBI",
        "NARMADA",
        "PANCH MAHALS",
        "PATAN",
        "PORBANDAR",
        "RAJKOT",
        "SABAR KANTHA",
        "SURAT",
        "SURENDRANAGAR",
        "TAPI",
        "VADODARA",
        "DANG",
        "NAVSARI",
        "VALSAD",
        "AHMEDABAD",
        "BANASKANTHA",
        "VADODARA / BARODA",
        "DANGS",
        "KUTCH",
        "MEHSANA",
        "PANCHMAHAL",
        "SABARKANTHA"
    ],
    "HARYANA": [
        "AMBALA",
        "BHIWANI",
        "CHARKI DADRI",
        "FARIDABAD",
        "FATEHABAD",
        "GURGAON",
        "HISAR",
        "JHAJJAR",
        "JIND",
        "KAITHAL",
        "KARNAL",
        "KURUKSHETRA",
        "MAHENDRAGARH",
        "MEWAT",
        "PALWAL",
        "PANCHKULA",
        "PANIPAT",
        "REWARI",
        "ROHTAK",
        "SIRSA",
        "SONIPAT",
        "YAMUNANAGAR",
        "HISSAR",
        "MAHENDRAGARH / NARNAUL"
    ],
    "HIMACHAL PRADESH": [
        "BILASPUR",
        "HAMIRPUR",
        "KANGRA",
        "MANDI",
        "SIRMAUR",
        "SOLAN",
        "UNA",
        "CHAMBA",
        "KINNAUR",
        "KULLU",
        "LAHUL AND SPITI",
        "SHIMLA",
        "BILASHPUR",
        "LAHUL & SPITI"
    ],
    "JAMMU AND KASHMIR": [
        "JAMMU",
        "KATHUA",
        "RAJAURI",
        "REASI",
        "SAMBA",
        "UDHAMPUR",
        "ANANTNAG",
        "BADGAM",
        "BANDIPORA",
        "BARAMULLA",
        "DODA",
        "GANDERBAL",
        "KISHTWAR",
        "KULGAM",
        "KUPWARA",
        "POONCH",
        "PULWAMA",
        "RAMBAN",
        "SHOPIAN",
        "SRINAGAR",
        "KARGIL",
        "LEH LADAKH"
    ],
    "JHARKHAND": [
        "BOKARO",
        "CHATRA",
        "DEOGHAR",
        "DHANBAD",
        "DUMKA",
        "EAST SINGHBUM",
        "GARHWA",
        "GIRIDIH",
        "GODDA",
        "GUMLA",
        "HAZARIBAGH",
        "JAMTARA",
        "KHUNTI",
        "KODERMA",
        "LATEHAR",
        "LOHARDAGA",
        "PAKUR",
        "PALAMU",
        "RAMGARH",
        "RANCHI",
        "SAHEBGANJ",
        "SARAIKELA KHARSAWAN",
        "SIMDEGA",
        "WEST SINGHBHUM",
        "SANTHAL PARAGANA / DUMKA",
        "PALAMAU",
        "SINGHBHUM"
    ],
    "KARNATAKA": [
        "BAGALKOTE",
        "BALLARI",
        "BANGALORE RURAL",
        "BELAGAVI",
        "BENGALURU URBAN",
        "BIDAR",
        "CHAMARAJANAGARA",
        "CHIKKABALLAPURA",
        "CHIKKAMAGALURU",
        "CHITRADURGA",
        "DAKSHINA KANNADA",
        "DAVANGERE",
        "DHARWAD",
        "GADAG",
        "HASSAN",
        "HAVERI",
        "KALABURAGI",
        "KODAGU",
        "KOLAR",
        "KOPPAL",
        "MANDYA",
        "MYSURU",
        "RAICHUR",
        "RAMANAGARA",
        "SHIVAMOGGA",
        "TUMAKURU",
        "UTTARA KANNADA",
        "VIJAYAPURA",
        "YADAGIRI",
        "UDUPI",
        "BAGALKOT",
        "BELGAUM",
        "BELLARY",
        "BIJAPUR",
        "CHAMARAJANAGAR",
        "CHIKMAGALUR",
        "GULBARGA",
        "MYSORE",
        "SHIMOGA",
        "TUMKUR",
        "UTTAR KANNAD",
        "DAKSHIN KANNAD",
        "CHIKBALLAPUR",
        "YADGIR",
        "BANGALORE",
        "SHIMOGE",
        "CHICKMAGALUR",
        "BIJAPUR / VIJAYAPURA",
        "GULBARGA / KALABURAGI",
        "KODAGU / COORG"
    ],
    "KERALA": [
        "IDUKKI",
        "PALAKKAD",
        "THRISSUR",
        "MALAPPURAM",
        "PATHANAMTHITTA",
        "WAYANAD",
        "ALAPPUZHA",
        "ERNAKULAM",
        "KANNUR",
        "KASARAGOD",
        "KOLLAM",
        "KOTTAYAM",
        "KOZHIKODE",
        "THIRUVANANTHAPURAM",
        "ERANAKULAM"
    ],
    "LADDAK": [
        "KARGIL",
        "LEH LADAKH"
    ],
    "MADHYA PRADESH": [
        "ALIRAJPUR",
        "ASHOKNAGAR",
        "BARWANI",
        "BASTAR",
        "BETUL",
        "BHIND",
        "BHOPAL",
        "BURHANPUR",
        "CHHATARPUR",
        "CHHINDWARA",
        "DANTEWADA",
        "DATIA",
        "DEWAS",
        "DHAR",
        "DINDORI",
        "GUNA",
        "HARDA",
        "HOSHANGABAD",
        "INDORE",
        "JABALPUR",
        "JHABUA",
        "KATNI",
        "KHANDWA",
        "KHARGONE",
        "MANDLA",
        "MANDSAUR",
        "MORENA",
        "NARSINGHPUR",
        "NEEMUCH",
        "PANNA",
        "RAISEN",
        "RAJGARH",
        "RAJNANDGAON",
        "RATLAM",
        "REWA",
        "SAGAR",
        "SATNA",
        "SEHORE",
        "SEONI",
        "SHAHDOL",
        "SHAJAPUR",
        "SHEOPUR",
        "SHIVPURI",
        "SIDHI",
        "SINGRAULI",
        "SURGUJA",
        "TIKAMGARH",
        "UJJAIN",
        "UMARIA",
        "VIDISHA",
        "AGAR MALWA",
        "ANUPPUR",
        "BALAGHAT",
        "BILASPUR",
        "DAMOH",
        "DHAMTARI",
        "DURG",
        "GWALIOR",
        "JANJGIR-CHAMPA",
        "JASHPUR",
        "KABIRDHAM",
        "KANKER",
        "KORBA",
        "KOREA",
        "MAHASAMUND",
        "RAIPUR",
        "NIWARI",
        "SEONI / SHIVANI",
        "KHARGONE / WEST NIMAR",
        "KHANDWA / EAST NIMAR"
    ],
    "MAHARASHTRA": [
        "AHMEDNAGAR",
        "AKOLA",
        "AMRAVATI",
        "AURANGABAD",
        "BEED",
        "BHANDARA",
        "BULDHANA",
        "CHANDRAPUR",
        "DHULE",
        "GADCHIROLI",
        "GONDIA",
        "HINGOLI",
        "JALGAON",
        "JALNA",
        "KOLHAPUR",
        "LATUR",
        "NAGPUR",
        "NANDED",
        "NANDURBAR",
        "NASHIK",
        "OSMANABAD",
        "PARBHANI",
        "PUNE",
        "SANGLI",
        "SATARA",
        "SOLAPUR",
        "WARDHA",
        "WASHIM",
        "YAVATMAL",
        "MUMBAI",
        "MUMBAI SUBURBAN",
        "PALGHAR",
        "RAIGAD",
        "RATNAGIRI",
        "SINDHUDURG",
        "THANE",
        "BOMBAY",
        "NASIK",
        "AMARAWATI",
        "YEOTMAL"
    ],
    "MANIPUR": [
        "CHURACHANDPUR",
        "IMPHAL WEST",
        "BISHNUPUR",
        "CHANDEL",
        "IMPHAL EAST",
        "SENAPATI",
        "TAMENGLONG",
        "THOUBAL",
        "UKHRUL"
    ],
    "MEGHALAYA": [
        "EAST GARO HILLS",
        "NORTH GARO HILLS",
        "SOUTH GARO HILLS",
        "SOUTH WEST GARO HILLS",
        "WEST GARO HILLS",
        "EAST JAINTIA HILLS",
        "EAST KHASI HILLS",
        "RI BHOI",
        "SOUTH WEST KHASI HILLS",
        "WEST JAINTIA HILLS",
        "WEST KHASI HILLS"
    ],
    "MIZORAM": [
        "AIZAWL",
        "CHAMPHAI",
        "KOLASIB",
        "LAWNGTLAI",
        "LUNGLEI",
        "MAMIT",
        "SAIHA",
        "SERCHHIP"
    ],
    "NAGALAND": [
        "DIMAPUR",
        "KOHIMA",
        "MOKOKCHUNG",
        "MON",
        "PHEK",
        "TUENSANG",
        "WOKHA",
        "ZUNHEBOTO",
        "KIPHIRE",
        "LONGLENG",
        "PEREN"
    ],
    "ODISHA": [
        "ANUGUL",
        "BALANGIR",
        "BARGARH",
        "BOUDH",
        "DHENKANAL",
        "GAJAPATI",
        "GANJAM",
        "KALAHANDI",
        "KANDHAMAL",
        "KENDUJHAR",
        "KORAPUT",
        "NABARANGPUR",
        "NAYAGARH",
        "NUAPADA",
        "RAYAGADA",
        "SONEPUR",
        "BALESHWAR",
        "BHADRAK",
        "CUTTACK",
        "DEOGARH",
        "JAGATSINGHAPUR",
        "JAJAPUR",
        "JHARSUGUDA",
        "KENDRAPARA",
        "KHORDHA",
        "MALKANGIRI",
        "MAYURBHANJ",
        "PURI",
        "SAMBALPUR",
        "SUNDARGARH"
    ],
    "ORISSA": [
        "BALASORE",
        "BOLANGIR",
        "CUTTACK",
        "DHENKANAL",
        "GANJAM",
        "KALAHANDI",
        "KEONJHAR",
        "KORAPUT",
        "MAYURBHANJA",
        "PHULBANI ( KANDHAMAL )",
        "PURI",
        "SAMBALPUR",
        "SUNDARGARH"
    ],
    "PUDUCHERRY": [
        "KARAIKAL",
        "PONDICHERRY",
        "MAHE",
        "YANAM"
    ],
    "PUNJAB": [
        "AMRITSAR",
        "BARNALA",
        "BATHINDA",
        "FARIDKOT",
        "FAZILKA",
        "FIROZEPUR",
        "JALANDHAR",
        "LUDHIANA",
        "MANSA",
        "MOGA",
        "MUKTSAR",
        "PATIALA",
        "SANGRUR",
        "TARN TARAN",
        "FATEHGARH SAHIB",
        "GURDASPUR",
        "HOSHIARPUR",
        "KAPURTHALA",
        "PATHANKOT",
        "RUPNAGAR",
        "S NAGAR",
        "SHAHID BHAGAT SINGH NAGAR",
        "NAWANSHAHR",
        "S",
        "ROOPNAGAR / ROPAR",
        "FEROZPUR",
        "BHATINDA"
    ],
    "RAJASTHAN": [
        "AJMER",
        "ALWAR",
        "BANSWARA",
        "BARAN",
        "BARMER",
        "BHARATPUR",
        "BHILWARA",
        "BIKANER",
        "BUNDI",
        "CHITTORGARH",
        "CHURU",
        "DAUSA",
        "DHOLPUR",
        "DUNGARPUR",
        "GANGANAGAR",
        "HANUMANGARH",
        "JAIPUR",
        "JAISALMER",
        "JALORE",
        "JHALAWAR",
        "JHUNJHUNU",
        "JODHPUR",
        "KARAULI",
        "KOTA",
        "NAGAUR",
        "PALI",
        "PRATAPGARH",
        "RAJSAMAND",
        "SAWAI MADHOPUR",
        "SIKAR",
        "SIROHI",
        "TONK",
        "UDAIPUR",
        "SWAMI MADHOPUR"
    ],
    "SIKKIM": [
        "EAST DISTRICT",
        "NORTH DISTRICT",
        "SOUTH DISTRICT",
        "WEST DISTRICT"
    ],
    "TAMIL NADU": [
        "ARIYALUR",
        "COIMBATORE",
        "CUDDALORE",
        "DHARMAPURI",
        "DINDIGUL",
        "ERODE",
        "KANCHIPURAM",
        "KANNIYAKUMARI",
        "KARUR",
        "KRISHNAGIRI",
        "MADURAI",
        "NAGAPATTINAM",
        "NAMAKKAL",
        "PERAMBALUR",
        "PUDUKKOTTAI",
        "RAMANATHAPURAM",
        "SALEM",
        "SIVAGANGA",
        "THANJAVUR",
        "THE NILGIRIS",
        "THENI",
        "THIRUVALLUR",
        "THIRUVARUR",
        "TIRUCHIRAPPALLI",
        "TIRUNELVELI",
        "TIRUPPUR",
        "TIRUVANNAMALAI",
        "TUTICORIN",
        "VELLORE",
        "VILLUPURAM",
        "VIRUDHUNAGAR",
        "CHENGALPATTU",
        "CHENNAI",
        "THOOTHUKUDI",
        "CHENGALPATTU MGR / KANCHIPURAM",
        "SOUTH ARCOT / CUDDALORE",
        "NORTH ARCOT / VELLORE",
        "TIRUCHIRAPALLI / TRICHY",
        "RAMANANTHAPURAM",
        "THIRUNELVELI",
        "KANYAKUMARI"
    ],
    "TELANGANA": [
        "ADILABAD",
        "BHADRADRI",
        "HANUMAKONDA",
        "JAGITIAL",
        "JANGOAN",
        "JAYASHANKAR",
        "JOGULAMBA",
        "KAMAREDDY",
        "KARIMNAGAR",
        "KHAMMAM",
        "KOMARAM BHEEM ASIFABAD",
        "MAHABUBABAD",
        "MAHBUBNAGAR",
        "MANCHERIAL",
        "MEDAK",
        "MEDCHAL MALKAJGIRI",
        "MULUGU",
        "NAGARKURNOOL",
        "NALGONDA",
        "NARAYANAPET",
        "NIRMAL",
        "NIZAMABAD",
        "PEDDAPALLI",
        "RAJANNA",
        "RANGAREDDI",
        "SANGAREDDY",
        "SIDDIPET",
        "SURYAPET",
        "VIKARABAD",
        "WANAPARTHY",
        "WARANGAL",
        "YADADRI",
        "MEDCHAL",
        "WARANGAL URBAN",
        "THE DADRA AND NAGAR HAVELI AND DAMAN AND DIU",
        "DADRA AND NAGAR HAVELI",
        "DAMAN",
        "HYDERABAD",
        "MAHABUBNAGAR"
    ],
    "THE DADRA AND NAGAR HAVELI": [
        "DADRA AND NAGAR HAVELI",
        "DAMAN"
    ],
    "TRIPURA": [
        "DHALAI",
        "GOMATI",
        "KHOWAI",
        "NORTH TRIPURA",
        "SEPAHIJALA",
        "SOUTH TRIPURA",
        "UNAKOTI",
        "WEST TRIPURA"
    ],
    "UTTAR PRADESH": [
        "AGRA",
        "ALIGARH",
        "AMROHA",
        "AZAMGARH",
        "BAGHPAT",
        "BANDA",
        "BARABANKI",
        "BAREILLY",
        "BIJNOR",
        "BUDAUN",
        "BULANDSHAHR",
        "CHANDAULI",
        "ETAH",
        "ETAWAH",
        "FIROZABAD",
        "GAUTAM BUDDHA NAGAR",
        "GHAZIABAD",
        "HAMIRPUR",
        "HARDOI",
        "HARIDWAR",
        "HATHRAS",
        "JALAUN",
        "JAUNPUR",
        "JHANSI",
        "KANNAUJ",
        "KANPUR DEHAT",
        "KANPUR NAGAR",
        "KASGANJ",
        "KUSHI NAGAR",
        "LUCKNOW",
        "MATHURA",
        "MEERUT",
        "MORADABAD",
        "MUZAFFARNAGAR",
        "PILIBHIT",
        "RAMPUR",
        "SAHARANPUR",
        "SANT KABEER NAGAR",
        "SANT RAVIDAS NAGAR",
        "SHAHJAHANPUR",
        "SHAMLI",
        "SITAPUR",
        "UDAM SINGH NAGAR",
        "ALLAHABAD",
        "ALMORA",
        "AMBEDKAR NAGAR",
        "AMETHI",
        "AURAIYA",
        "BAGESHWAR",
        "BAHRAICH",
        "BALLIA",
        "BALRAMPUR",
        "BASTI",
        "CHAMOLI",
        "CHAMPAWAT",
        "CHITRAKOOT",
        "DEHRADUN",
        "DEORIA",
        "FAIZABAD",
        "FARRUKHABAD",
        "FATEHPUR",
        "GHAZIPUR",
        "GONDA",
        "GORAKHPUR",
        "HAPUR",
        "KAUSHAMBI",
        "KHERI",
        "LALITPUR",
        "MAHARAJGANJ",
        "MAHOBA",
        "MAINPURI",
        "MAU",
        "MIRZAPUR",
        "NAINITAL",
        "PAURI GARHWAL",
        "PITHORAGARH",
        "PRATAPGARH",
        "RAE BARELI",
        "RUDRA PRAYAG",
        "SAMBHAL",
        "SHRAVASTI",
        "SIDDHARTH NAGAR",
        "SONBHADRA",
        "SULTANPUR",
        "TEHRI GARHWAL",
        "UNNAO",
        "UTTAR KASHI",
        "VARANASI",
        "BULAND SHAHAR",
        "KANPUR",
        "MIRZPUR",
        "RAE-BAREILY"
    ],
    "UTTARAKHAND": [
        "ALMORA",
        "BAGESHWAR",
        "CHAMOLI",
        "CHAMPAWAT",
        "DEHRADUN",
        "HARIDWAR",
        "NAINITAL",
        "PAURI GARHWAL",
        "PITHORAGARH",
        "RUDRA PRAYAG",
        "TEHRI GARHWAL",
        "UDAM SINGH NAGAR",
        "UTTAR KASHI",
        "ALMORAH",
        "PITHORGARH",
        "GARHWAL"
    ],
    "WEST BENGAL": [
        "PARAGANAS NORTH",
        "BANKURA",
        "BIRBHUM",
        "HOWRAH",
        "MEDINIPUR EAST",
        "MEDINIPUR WEST",
        "PURBA BARDHAMAN",
        "PURULIA",
        "PARAGANAS SOUTH",
        "ALIPURDUAR",
        "COOCHBEHAR",
        "DARJEELING",
        "DINAJPUR DAKSHIN",
        "DINAJPUR UTTAR",
        "HOOGHLY",
        "JALPAIGURI",
        "JHARGRAM",
        "KALIMPONG",
        "MALDAH",
        "MURSHIDABAD",
        "NADIA",
        "PASCHIM BARDHAMAN",
        "24 PARAGANAS NORTH",
        "24 PARAGANAS SOUTH",
        "24 PARGANAS",
        "BURDWAN",
        "MALDA",
        "COOCH BEHAR",
        "MIDNAPUR",
        "WEST DINAJPUR"
    ]
};

// ==========================================
// 2. MAIN EXECUTION BLOCK
// ==========================================
document.addEventListener("DOMContentLoaded", function() {
    
    // UI Setup
    const savedName = localStorage.getItem("farmerName") || "Farmer";
    const userProfileName = document.getElementById("sidebar-user-name");
    if (userProfileName) userProfileName.innerText = savedName;

    // Dropdown Setup
    const stateSelect = document.getElementById('state-select');
    const districtSelect = document.getElementById('district-select');

    if (stateSelect) {
        for (let state in locationData) {
            let option = document.createElement("option"); option.value = state; option.text = state;
            stateSelect.appendChild(option);
        }
        stateSelect.addEventListener('change', function() {
            districtSelect.innerHTML = '<option value="">-- Select District --</option>';
            if (this.value && locationData[this.value]) {
                districtSelect.disabled = false;
                locationData[this.value].forEach(district => {
                    let opt = document.createElement('option'); opt.value = district; opt.text = district;
                    districtSelect.appendChild(opt);
                });
            } else { districtSelect.disabled = true; }
        });
    }

    // Weather Button Listener
    const fetchBtn = document.getElementById('fetch-weather-btn');
    if (fetchBtn) {
        fetchBtn.addEventListener('click', function() {
            const dist = districtSelect.value;
            const st = stateSelect.value;
            if (!dist || !st) {
                showToast("Please select a State and District first!", "error");
                return;
            }
            fetchRealWeather(dist, st); 
        });
    }

    // Yield Prediction Form
    const yieldForm = document.getElementById('yield-form');
    if (yieldForm) {
        yieldForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const btn = document.getElementById('predict-btn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = `<div class="btn-loading"><div class="spinner"></div> Running AI...</div>`;
            btn.disabled = true;

            const payload = {
                state: stateSelect.value,
                district: districtSelect.value,
                crop: document.getElementById('crop-select').value,
                season: document.getElementById('season-select').value,
                area: document.getElementById('area-input').value,
                temp: document.getElementById('temp-input').value,
                rain: document.getElementById('rain-input').value
            };

            fetch('/api/predict_yield', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('result-box').classList.remove('hidden');
                    animateValue(document.getElementById('yield-output'), 0, data.prediction, 1500, " Tonnes");
                    document.getElementById('result-box').scrollIntoView({ behavior: 'smooth' });
                } else {
                    showToast("AI Error: " + data.error, "error");
                }
            })
            .catch(err => showToast("Connection error.", "error"))
            .finally(() => { btn.innerHTML = originalText; btn.disabled = false; });
        });
    }
});

// ==========================================
// 3. GLOBAL UTILITIES (Outside DOMContentLoaded)
// ==========================================

function showToast(message, type="error") {
    let container = document.querySelector('.toast-container') || document.body.appendChild(document.createElement('div'));
    container.className = 'toast-container';
    const toast = document.createElement('div'); toast.className = `toast ${type}`; toast.innerText = message;
    container.appendChild(toast);
    setTimeout(() => toast.remove(), 3500);
}

function animateValue(obj, start, end, duration, suffix = "") {
    let startTimestamp = null;
    const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        const ease = 1 - Math.pow(1 - progress, 4);
        let val = ease * (end - start) + start;
        obj.innerHTML = `${val.toFixed(2)} <span style="font-size: 20px; color: #555;">${suffix}</span>`;
        if (progress < 1) window.requestAnimationFrame(step);
    };
    window.requestAnimationFrame(step);
}

function fetchRealWeather(district, state) {
    const btn = document.getElementById('fetch-weather-btn');
    const originalText = btn.innerHTML;
    btn.innerHTML = `<div class="btn-loading"><div class="spinner dark"></div> Fetching...</div>`;
    btn.disabled = true;

    fetch('/api/get_weather', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ district: district, state: state })
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            document.getElementById('temp-input').value = data.temp;
            document.getElementById('rain-input').value = data.rain;
            showToast("Live weather updated!", "success");
        } else {
            showToast("Weather fetch failed: " + data.error, "error");
        }
    })
    .catch(err => showToast("Server error.", "error"))
    .finally(() => { 
        btn.innerHTML = originalText; 
        btn.disabled = false; 
    });
}